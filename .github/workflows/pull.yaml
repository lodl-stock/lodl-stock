name: pull-code
on:
  workflow_dispatch:
  workflow_call:

jobs:
  pull-code:
    runs-on: ubuntu-latest
    steps:
      - name: SSH Remote Commands
        uses: appleboy/ssh-action@v0.1.2
        with:
          key: ${{secrets.SSH_PRIVATE_KEY}}
          host: ${{secrets.DOCKER_PG_URL}}
          username: ${{secrets.DOCKER_PG_USERNAME}}
          debug: true
          port: 8022
          use_insecure_cipher: true
          # proxy_port: 8022
          proxy_use_insecure_cipher: true
          script: |
            ls lodl-stock || git pull https://github.com/lodl-stock/lodl-stock.git
            cd lodk-stock/
            git checkout main
            git fetch origin
            git reset --hard origin/main
